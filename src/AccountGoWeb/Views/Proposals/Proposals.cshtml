@model string

<style>
    .ag-row-selected {
        background-color: darkorange;
        color: white;
        border-color: aqua;
        opacity: 0.9;
    }
</style>

<div>
    <a href="~/proposals/addsalesproposal" class="btn btn-outline-light">
        <i class="fa fa-plus"></i>
        New Proposal
    </a>
    <a href="~/proposals/editsalesproposal" id="linkEditProposal" class="btn inactiveLink">
        <i class="fa fa-edit"></i>
        Edit
    </a>
    <a href="~/proposals/deletesalesproposal" id="linkDeleteProposal" class="btn inactiveLink">
        <i class="fa fa-trash"></i>
        Delete
    </a>
    <a href="" id="linkNewOrder" class="btn inactiveLink">
        <i class="fa fa-plus"></i>
        New Order
    </a>
</div>

<div>
    <div id="proposals" class="ag-fresh" style="height: 400px;"></div>
</div>

<script>
    var columnDefs = [
    {headerName: "No", field: "no", width: 50},
    { headerName: "Customer Name", field: "customerName", width: 130 },
    {headerName: "Description", field: "description", width: 170},
    { headerName: "Delivery Date", field: "deliveryDate", width: 170 },
    {headerName: "Amount" , field: "totalAmount", width : 130}
    ];

    var gridOptions = {
        columnDefs: columnDefs,
        rowData: @Html.Raw(Model),
        enableSorting: true,
        // PROPERTIES - simple boolean / string / number properties
        rowSelection: 'single',
        onSelectionChanged: onSelectionChanged,
    };

    function onSelectionChanged() {
        var selectedRows = gridOptions.api.getSelectedRows();
        selectedRow = selectedRows[0];

        document.getElementById('linkEditProposal').setAttribute('href', 'proposal?id=' + selectedRow.id);
        document.getElementById('linkEditProposal').setAttribute('class', 'btn btn-outline-light');

        document.getElementById('linkDeleteProposal').setAttribute('class', 'btn btn-outline-light');

        document.getElementById('linkNewOrder').setAttribute('class', 'btn btn-outline-light');
        console.log(selectedRows);
        document.getElementById('linkNewOrder').innerHTML += ("(Next Step - No" + selectedRows[0].no + " Proposal)");

        // if(selectedRow.status == 3)
        // {
        //     document.getElementById('linkNewOrder').setAttribute('class', 'btn inactiveLink');
        // }
        // else if (selectedRow.status == 1){
        //     document.getElementById('linkNewOrder').setAttribute('href', '/sales/salesorder?quotationId=' + selectedRow.id);
        //     document.getElementById('linkNewOrder').setAttribute('class', 'btn');
        // }
    }

    // wait for the document to be loaded, otherwise
    // ag-Grid will not find the div in the document.
    document.addEventListener("DOMContentLoaded", function() {
        var eGridDiv = document.querySelector('#proposals');
        new agGrid.Grid(eGridDiv, gridOptions);
    });
</script>
